name: Unit Test

on:
  workflow_dispatch:
  pull_request:
    branches: main
  push:
    branches: main

jobs:
  build:
    strategy:
      matrix:
        os:
        - ubuntu-latest
        - ubuntu-24.04-arm
        - windows-latest
        # - windows-11-arm
    runs-on: ${{ matrix.os }}

    steps:
    - name: â¤µï¸ Checkout Source
      uses: actions/checkout@v5

    - name: ğŸ› ï¸ Setup .NET
      uses: actions/setup-dotnet@v5
      with:
        global-json-file: global.json
        dotnet-version: |
          8.0.x
          9.0.x

    # cspell:ignore devel
    - name: ğŸ› ï¸ Install mono
      if: startsWith(matrix.os, 'ubuntu')
      run: |
        sudo apt-get update
        sudo apt-get install -y mono-devel

    - name: ğŸ› ï¸ Restore dependencies
      run: dotnet restore

    - name: ğŸ”¨ Build
      run: dotnet build

    - name: ğŸ”¨ Build Dummy projects
      run: dotnet build Tests/Dummies/Dummies.slnx

    - name: ğŸ§ª Test
      run: dotnet test --no-progress --no-build
